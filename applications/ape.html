<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Données émergentes - Application 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../textes_exemples.html" rel="next">
<link href="../textes.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Données émergentes - Application 1">
<meta property="og:description" content="">
<meta property="og:site_name" content="Données émergentes">
<meta name="twitter:title" content="Données émergentes - Application 1">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@linogaliana">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Données émergentes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../introduction.html" aria-current="page"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-données-administratives" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Données administratives</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-données-administratives">    
        <li>
    <a class="dropdown-item" href="../administratives.html">
 <span class="dropdown-text">Données administratives</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../administratives_exemples.html">
 <span class="dropdown-text">Quelques exemples approfondis de données administratives</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-données-géolocalisées" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Données géolocalisées</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-données-géolocalisées">    
        <li>
    <a class="dropdown-item" href="../geolocalized_data.html">
 <span class="dropdown-text">Données géolocalisées</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../geolocalized_data_exemples.html">
 <span class="dropdown-text">Application</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analyse-textuelle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analyse textuelle</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analyse-textuelle">    
        <li>
    <a class="dropdown-item" href="../textes.html">
 <span class="dropdown-text">Données textuelles et non structurées</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../applications/ape.html">
 <span class="dropdown-text">Application 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../textes_exemples.html">
 <span class="dropdown-text">Application 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analyse-dimages" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analyse d’images</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analyse-dimages">    
        <li>
    <a class="dropdown-item" href="../images.html">
 <span class="dropdown-text">Images</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../images_exemples.html">
 <span class="dropdown-text">Application</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-nowcasting" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Nowcasting</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-nowcasting">    
        <li>
    <a class="dropdown-item" href="../series_temporelles.html">
 <span class="dropdown-text">Nowcasting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../nowcasting_exemples.html">
 <span class="dropdown-text">Application</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../textes.html">Analyse textuelle</a></li><li class="breadcrumb-item"><a href="../applications/ape.html">Application 1</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
        <div class="sidebar-tools-collapse">
    <a href="https://twitter.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-collapse-item" href="https://github.com/InseeFrLab/cours-nouvelles-donnees-site">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-collapse-item" href="https://github.com/InseeFrLab/cours-nouvelles-donnees-site/issues">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Données administratives</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../administratives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Données administratives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../administratives_exemples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quelques exemples approfondis de données administratives</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Données géolocalisées</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../geolocalized_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Données géolocalisées</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../geolocalized_data_exemples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Application</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Analyse textuelle</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../textes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Données textuelles et non structurées</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../applications/ape.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Application 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../textes_exemples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Application 2</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Analyse d’images</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../images.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Images</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../images_exemples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Application</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Nowcasting</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../series_temporelles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nowcasting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nowcasting_exemples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Application</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#exploration-du-jeu-de-données" id="toc-exploration-du-jeu-de-données" class="nav-link active" data-scroll-target="#exploration-du-jeu-de-données">Exploration du jeu de données</a></li>
  <li><a href="#premier-algorithme-dapprentissage-supervisé" id="toc-premier-algorithme-dapprentissage-supervisé" class="nav-link" data-scroll-target="#premier-algorithme-dapprentissage-supervisé">Premier algorithme d’apprentissage supervisé</a></li>
  <li><a href="#pour-aller-plus-loin-introduction-au-mlops" id="toc-pour-aller-plus-loin-introduction-au-mlops" class="nav-link" data-scroll-target="#pour-aller-plus-loin-introduction-au-mlops">Pour aller plus loin, introduction au MLOps</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/InseeFrLab/cours-nouvelles-donnees-site/edit/main/applications/ape.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/InseeFrLab/cours-nouvelles-donnees-site/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../textes.html">Analyse textuelle</a></li><li class="breadcrumb-item"><a href="../applications/ape.html">Application 1</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Application 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Cette application illustrera certains apports des outils du NLP pour la codification automatique des déclarations d’activité dans la nomenclature des activités françaises. On pourra coder dans un notebook au sein de l’environnement <code>SSP Cloud</code> suivant:</p>
<p><a href="https://datalab.sspcloud.fr/launcher/ide/jupyter-python?autoLaunch=true&amp;onyxia.friendlyName=%C2%ABpython-datascience%C2%BB&amp;init.personalInit=%C2%ABhttps%3A%2F%2Fraw.githubusercontent.com%2Ftomseimandi%2Finit-scripts%2Fmain%2Fcours-ensai.sh%C2%BB&amp;security.allowlist.enabled=false" target="_blank" rel="noopener"><img src="https://img.shields.io/badge/SSPcloud-Tester%20via%20SSP--cloud-informational&amp;color=yellow?logo=Python" alt="Onyxia"></a></p>
<section id="exploration-du-jeu-de-données" class="level2">
<h2 class="anchored" data-anchor-id="exploration-du-jeu-de-données">Exploration du jeu de données</h2>
<p>Ce tutoriel se propose d’illustrer la problématique de la classification automatique par le biais de l’algorithme d’apprentissage supervisé <code>fastText</code> à partir des données issues des déclarations Sirene.</p>
<p>Le code pour lire les données est directement fourni:</p>
<div id="a384e074" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>DATA_PATH <span class="op">=</span> <span class="st">"https://minio.lab.sspcloud.fr/projet-formation/diffusion/mlops/data/firm_activity_data.parquet"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>NAF_PATH <span class="op">=</span> <span class="st">"https://www.insee.fr/fr/statistiques/fichier/2120875/naf2008_liste_n5.xls"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>naf <span class="op">=</span> pd.read_excel(NAF_PATH, skiprows <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>naf[<span class="st">'Code'</span>] <span class="op">=</span> naf[<span class="st">'Code'</span>].<span class="bu">str</span>.replace(<span class="st">"."</span>,<span class="st">""</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_parquet(DATA_PATH)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> train.merge(naf, left_on <span class="op">=</span> <span class="st">"nace"</span>, right_on <span class="op">=</span> <span class="st">"Code"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>train.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nace</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">Code</th>
<th data-quarto-table-cell-role="th">Libellé</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8220Z</td>
<td>MISSIONS PONCTUELLES A L AIDE D UNE PLATEFORME</td>
<td>8220Z</td>
<td>Activités de centres d'appels</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8553Z</td>
<td>INSPECTEUR AUTOMOBILE</td>
<td>8553Z</td>
<td>Enseignement de la conduite</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5520Z</td>
<td>LA LOCATION TOURISTIQUE DE LOGEMENTS INSOLITES...</td>
<td>5520Z</td>
<td>Hébergement touristique et autre hébergement d...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4791A</td>
<td>COMMERCE DE TOUT ARTICLES ET PRODUITS MARCHAND...</td>
<td>4791A</td>
<td>Vente à distance sur catalogue général</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>9499Z</td>
<td>REGROUPEMENT RETRAITE</td>
<td>9499Z</td>
<td>Autres organisations fonctionnant par adhésion...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Le premier exercice a vocation à illustrer la manière classique de rentrer dans un corpus de données textuelles. La démarche n’est pas particulièrement originale mais permet d’illustrer les enjeux du nettoyage de texte.</p>
<div class="cell markdown">
<div class="alert alert-success" role="alert">
<h3 class="alert-heading anchored"><i class="fa-solid fa-pencil"></i> Exercice 1 </h3>
<ol type="1">
<li><p>Créer une fonction pour compter le nombre de textes contenant une séquence de caractères donnée dans le corpus. La tester avec <em>“data science”</em> et <em>“boulanger”</em>.</p></li>
<li><p>Faire une fonction pour afficher le <em>wordcloud</em> de notre corpus dans son ensemble et de certaines catégories pour comprendre la nature de notre corpus.</p></li>
<li><p>Retirer les stopwords à partir de la liste des mots disponibles dans <code>SpaCy</code>.</p></li>
</ol>
<details>
<summary>
Aide
</summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">"fr_core_news_sm"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>stop_words <span class="op">=</span> <span class="co">#liste de stopwords</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to remove stopwords</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_stopwords(text):</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    word_tokens <span class="op">=</span> word_tokenize(text)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    filtered_text <span class="op">=</span> [word <span class="cf">for</span> word <span class="kw">in</span> word_tokens <span class="cf">if</span> word.lower() <span class="kw">not</span> <span class="kw">in</span> stop_words]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">' '</span>.join(filtered_text)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_single_letters(text):</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    word_tokens <span class="op">=</span> word_tokenize(text)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    filtered_text <span class="op">=</span> [word <span class="cf">for</span> word <span class="kw">in</span> word_tokens <span class="cf">if</span> <span class="bu">len</span>(word) <span class="op">&gt;</span> <span class="dv">1</span>]</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">' '</span>.join(filtered_text)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to the 'text' column</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>train[<span class="st">'text_clean'</span>] <span class="op">=</span> (train[<span class="st">'text'</span>]</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(remove_stopwords)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(remove_single_letters)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<ol start="4" type="1">
<li>Refaire quelques uns des nuages de mots et étudier la différence avant nettoyage.</li>
</ol>
</div>
</div>
<p>Dans une démarche exploratoire, le plus simple est de commencer par compter les mots de manière indépendante (approche sac de mot). Par exemple, de manière naturelle, nous avons beaucoup plus de déclarations liées à la boulangerie que liées à la <em>data science</em>:</p>
<div id="2b5cb849" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>filter_train_data(train, <span class="st">"data science"</span>).head(<span class="dv">5</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>filter_train_data(train, <span class="st">"boulanger"</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nombre d'occurrences de la séquence 'data science': 54
Nombre d'occurrences de la séquence 'boulanger': 1928</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nace</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">Code</th>
<th data-quarto-table-cell-role="th">Libellé</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">90</td>
<td>1071C</td>
<td>BOULANGERIE PATISSERIE VIENNOISERIE</td>
<td>1071C</td>
<td>Boulangerie et boulangerie-pâtisserie</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">107</td>
<td>1071C</td>
<td>BOULANGERIE PATISSERIE FABRICATION</td>
<td>1071C</td>
<td>Boulangerie et boulangerie-pâtisserie</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">153</td>
<td>1071C</td>
<td>BOULANGERIE PATISSERIE GLACES CONFISERIES BOIS...</td>
<td>1071C</td>
<td>Boulangerie et boulangerie-pâtisserie</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">314</td>
<td>1071C</td>
<td>BOULANGERIE PATISSERIE VIENNOISERIE CONFISE...</td>
<td>1071C</td>
<td>Boulangerie et boulangerie-pâtisserie</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">487</td>
<td>1071C</td>
<td>BOULANGERIE PATISSERIE ACHAT VENTE ET MAINT...</td>
<td>1071C</td>
<td>Boulangerie et boulangerie-pâtisserie</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Les <em>wordclouds</em> peuvent servir à rapidement visualiser la structure d’un corpus. On voit ici que notre corpus est très bruité car nous n’avons pas nettoyé celui-ci:</p>
<div id="b47d973b" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ape_files/figure-html/cell-6-output-1.png" width="540" height="345" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Pour commencer à se faire une idée sur les spécificités des catégories, on peut représenter le corpus de certaines d’entre elles ? Arrivez-vous à inférer la catégorie de la NAF en question ? Si oui, vous utilisez sans doute des heuristiques proches de celles que nous allons mettre en oeuvre dans notre algorithme de classification.</p>
<div id="8d5cda69" class="cell" data-execution_count="6">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ape_files/figure-html/cell-7-output-1.png" width="540" height="345" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="8bea42a1" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ape_files/figure-html/cell-8-output-1.png" width="540" height="345" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Néanmoins, à ce stade, les données sont encore très bruitées. La première étape classique est de retirer les <em>stop words</em> et éventuellement des termes spécifiques à notre corpus. Par exemple, pour des données de caisse, on retirera les bruits, les abréviations, etc. qui peuvent bruiter notre corpus.</p>
</section>
<section id="premier-algorithme-dapprentissage-supervisé" class="level2">
<h2 class="anchored" data-anchor-id="premier-algorithme-dapprentissage-supervisé">Premier algorithme d’apprentissage supervisé</h2>
<p>Nous avons nettoyé nos données. Cela devrait améliorer la pertinence de nos modèles en réduisant le ratio signal/bruit. Nous allons généraliser notre nettoyage de texte en appliquant un peu plus d’étapes que précédemment. Nous allons notamment raciniser nos mots.</p>
<p>Pour cela, récupérer les fichiers suivants:</p>
<ul>
<li><a href="https://github.com/InseeFrLab/cours-nouvelles-donnees-site/blob/main/applications/constants.py"><code>constants.py</code></a></li>
<li><a href="https://github.com/InseeFrLab/cours-nouvelles-donnees-site/blob/main/applications/processor.py"><code>preprocessor.py</code></a></li>
<li><a href="https://github.com/InseeFrLab/cours-nouvelles-donnees-site/blob/main/applications/utils.py"><code>utils.py</code></a></li>
</ul>
<p>et mettre ceux-ci dans le même dossier que votre <em>notebook</em> <code>Jupyter</code>.</p>
<p>Le code de nettoyage est directement fourni:</p>
<div id="3473d250" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> processor <span class="im">import</span> Preprocessor</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> Preprocessor()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocess data before training and testing</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>TEXT_FEATURE <span class="op">=</span> <span class="st">"text"</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> <span class="st">"nace"</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> preprocessor.clean_text(train, TEXT_FEATURE).drop(<span class="st">'text_clean'</span>, axis <span class="op">=</span> <span class="st">"columns"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nace</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">Code</th>
<th data-quarto-table-cell-role="th">Libellé</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8220Z</td>
<td>mission ponctuel aid plateform</td>
<td>8220Z</td>
<td>Activités de centres d'appels</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8553Z</td>
<td>inspecteur automobil</td>
<td>8553Z</td>
<td>Enseignement de la conduite</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Nous allons commencer à entraîner un modèle dont le plongement de mot est de faible dimension. Voici les paramètres qui seront utiles pour le prochain exercice.</p>
<div id="d96b462e" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pathlib</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dim"</span>: <span class="dv">25</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"label_prefix"</span>: <span class="st">"__label__"</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>data_path <span class="op">=</span> pathlib.Path(<span class="st">"./data"</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>data_path.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> write_training_data(df, params, training_data_path<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    warnings.filterwarnings(<span class="st">"ignore"</span>, <span class="st">"Setuptools is replacing distutils."</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> training_data_path <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        training_data_path <span class="op">=</span> get_root_path() <span class="op">/</span> <span class="st">"data/training_data.txt"</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(training_data_path, <span class="st">"w"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _, item <span class="kw">in</span> df.iterrows():</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>            formatted_item <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>params[<span class="st">'label_prefix'</span>]<span class="sc">}{</span>item[Y]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>item[TEXT_FEATURE]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>            <span class="bu">file</span>.write(<span class="ss">f"</span><span class="sc">{</span>formatted_item<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> training_data_path.as_posix()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell markdown">
<div class="alert alert-success" role="alert">
<h3 class="alert-heading anchored"><i class="fa-solid fa-pencil"></i> Exercice 2 </h3>
<ol type="1">
<li>Découper notre échantillon complet en <em>train</em> et <em>test</em>.</li>
<li><code>fastText</code> effectue son entraînement à partir d’objets stockés dans un <code>.txt</code>. Utiliser la fonction <code>write_training_data</code> de la manière suivante pour l’écrire.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Write training data in a .txt file (fasttext-specific)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>training_data_path <span class="op">=</span> write_training_data(df_train, params, pathlib.Path(<span class="bu">str</span>(data_path.absolute()) <span class="op">+</span> <span class="st">"/training_data.txt"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li><p>Avec l’aide de la documentation de la librairie <code>Python</code>, entraîner votre modèle de classification.</p></li>
<li><p>Sauvegarder le modèle sous forme de binaire, cela pourra éventuellement servir ultérieurement.</p></li>
<li><p>Renvoyer les trois catégories les plus probables pour les nouveaux libellés suivants:</p></li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>list_libs <span class="op">=</span> [<span class="st">"vendeur d'huitres"</span>, <span class="st">"boulanger"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="6" type="1">
<li>Sur l’ensemble du jeu de test, renvoyer la meilleure prédiction pour chaque descriptif d’activités. Evaluer la performance globale et la performance classe par classe, par exemple en calculant le rappel (pour les classes de plus de 200 cas).</li>
</ol>
</div>
</div>
<div id="dd6aefb8" class="cell" data-execution_count="13">
<div class="cell-output cell-output-stderr">
<pre><code>Read 1M wordsRead 2M wordsRead 3M wordsRead 4M wordsRead 4M words
Number of words:  26820
Number of labels: 699
Progress:   0.3% words/sec/thread:  222222 lr:  0.099729 avg.loss:  8.334959 ETA:   0h 0m37sProgress:   0.5% words/sec/thread:  221898 lr:  0.099455 avg.loss:  6.489203 ETA:   0h 0m36sProgress:   0.8% words/sec/thread:  222016 lr:  0.099178 avg.loss:  5.491721 ETA:   0h 0m36sProgress:   1.1% words/sec/thread:  220704 lr:  0.098909 avg.loss:  4.788203 ETA:   0h 0m36sProgress:   1.4% words/sec/thread:  221082 lr:  0.098639 avg.loss:  4.211728 ETA:   0h 0m36sProgress:   1.6% words/sec/thread:  221480 lr:  0.098368 avg.loss:  3.832979 ETA:   0h 0m36sProgress:   1.9% words/sec/thread:  221609 lr:  0.098098 avg.loss:  3.549031 ETA:   0h 0m36sProgress:   2.2% words/sec/thread:  221965 lr:  0.097825 avg.loss:  3.334481 ETA:   0h 0m36sProgress:   2.4% words/sec/thread:  222204 lr:  0.097553 avg.loss:  3.164074 ETA:   0h 0m36sProgress:   2.7% words/sec/thread:  222170 lr:  0.097284 avg.loss:  3.014777 ETA:   0h 0m36sProgress:   3.0% words/sec/thread:  222141 lr:  0.097014 avg.loss:  2.873260 ETA:   0h 0m35sProgress:   3.3% words/sec/thread:  222026 lr:  0.096746 avg.loss:  2.808947 ETA:   0h 0m35sProgress:   3.5% words/sec/thread:  222014 lr:  0.096477 avg.loss:  2.743132 ETA:   0h 0m35sProgress:   3.8% words/sec/thread:  221600 lr:  0.096214 avg.loss:  2.666778 ETA:   0h 0m35sProgress:   4.1% words/sec/thread:  221444 lr:  0.095948 avg.loss:  2.589062 ETA:   0h 0m35sProgress:   4.3% words/sec/thread:  221457 lr:  0.095679 avg.loss:  2.513007 ETA:   0h 0m35sProgress:   4.6% words/sec/thread:  221440 lr:  0.095410 avg.loss:  2.448326 ETA:   0h 0m35sProgress:   4.9% words/sec/thread:  221642 lr:  0.095137 avg.loss:  2.389624 ETA:   0h 0m35sProgress:   5.1% words/sec/thread:  221795 lr:  0.094864 avg.loss:  2.334245 ETA:   0h 0m35sProgress:   5.4% words/sec/thread:  221772 lr:  0.094596 avg.loss:  2.284260 ETA:   0h 0m35sProgress:   5.7% words/sec/thread:  221790 lr:  0.094326 avg.loss:  2.232221 ETA:   0h 0m35sProgress:   5.9% words/sec/thread:  221878 lr:  0.094054 avg.loss:  2.187194 ETA:   0h 0m34sProgress:   6.2% words/sec/thread:  221834 lr:  0.093786 avg.loss:  2.148152 ETA:   0h 0m34sProgress:   6.5% words/sec/thread:  221458 lr:  0.093528 avg.loss:  2.113349 ETA:   0h 0m34sProgress:   6.7% words/sec/thread:  221532 lr:  0.093257 avg.loss:  2.074541 ETA:   0h 0m34sProgress:   7.0% words/sec/thread:  221520 lr:  0.092988 avg.loss:  2.041353 ETA:   0h 0m34sProgress:   7.3% words/sec/thread:  221515 lr:  0.092719 avg.loss:  2.008992 ETA:   0h 0m34sProgress:   7.6% words/sec/thread:  221557 lr:  0.092449 avg.loss:  1.979816 ETA:   0h 0m34sProgress:   7.8% words/sec/thread:  221487 lr:  0.092182 avg.loss:  1.952689 ETA:   0h 0m34sProgress:   8.1% words/sec/thread:  221552 lr:  0.091911 avg.loss:  1.926539 ETA:   0h 0m34sProgress:   8.4% words/sec/thread:  221586 lr:  0.091641 avg.loss:  1.902669 ETA:   0h 0m34sProgress:   8.6% words/sec/thread:  221556 lr:  0.091373 avg.loss:  1.877792 ETA:   0h 0m33sProgress:   8.9% words/sec/thread:  221530 lr:  0.091105 avg.loss:  1.855325 ETA:   0h 0m33sProgress:   9.2% words/sec/thread:  221384 lr:  0.090842 avg.loss:  1.834237 ETA:   0h 0m33sProgress:   9.4% words/sec/thread:  221373 lr:  0.090573 avg.loss:  1.812660 ETA:   0h 0m33sProgress:   9.7% words/sec/thread:  221307 lr:  0.090307 avg.loss:  1.790830 ETA:   0h 0m33sProgress:  10.0% words/sec/thread:  221291 lr:  0.090039 avg.loss:  1.774563 ETA:   0h 0m33sProgress:  10.2% words/sec/thread:  221276 lr:  0.089771 avg.loss:  1.756998 ETA:   0h 0m33sProgress:  10.5% words/sec/thread:  221348 lr:  0.089499 avg.loss:  1.740047 ETA:   0h 0m33sProgress:  10.8% words/sec/thread:  221303 lr:  0.089233 avg.loss:  1.721676 ETA:   0h 0m33sProgress:  11.0% words/sec/thread:  221322 lr:  0.088963 avg.loss:  1.705550 ETA:   0h 0m33sProgress:  11.3% words/sec/thread:  221308 lr:  0.088695 avg.loss:  1.686978 ETA:   0h 0m33sProgress:  11.6% words/sec/thread:  221359 lr:  0.088424 avg.loss:  1.671093 ETA:   0h 0m32sProgress:  11.8% words/sec/thread:  221307 lr:  0.088158 avg.loss:  1.659806 ETA:   0h 0m32sProgress:  12.1% words/sec/thread:  221275 lr:  0.087891 avg.loss:  1.646089 ETA:   0h 0m32sProgress:  12.4% words/sec/thread:  221307 lr:  0.087620 avg.loss:  1.632876 ETA:   0h 0m32sProgress:  12.6% words/sec/thread:  221268 lr:  0.087354 avg.loss:  1.621455 ETA:   0h 0m32sProgress:  12.9% words/sec/thread:  221289 lr:  0.087084 avg.loss:  1.608689 ETA:   0h 0m32sProgress:  13.2% words/sec/thread:  221329 lr:  0.086812 avg.loss:  1.598138 ETA:   0h 0m32sProgress:  13.5% words/sec/thread:  221312 lr:  0.086545 avg.loss:  1.590196 ETA:   0h 0m32sProgress:  13.7% words/sec/thread:  221317 lr:  0.086275 avg.loss:  1.583292 ETA:   0h 0m32sProgress:  14.0% words/sec/thread:  221305 lr:  0.086007 avg.loss:  1.576262 ETA:   0h 0m32sProgress:  14.3% words/sec/thread:  221287 lr:  0.085740 avg.loss:  1.569649 ETA:   0h 0m31sProgress:  14.5% words/sec/thread:  221293 lr:  0.085471 avg.loss:  1.563027 ETA:   0h 0m31sProgress:  14.8% words/sec/thread:  221172 lr:  0.085210 avg.loss:  1.552657 ETA:   0h 0m31sProgress:  15.1% words/sec/thread:  221172 lr:  0.084942 avg.loss:  1.542013 ETA:   0h 0m31sProgress:  15.3% words/sec/thread:  221171 lr:  0.084673 avg.loss:  1.530227 ETA:   0h 0m31sProgress:  15.6% words/sec/thread:  221202 lr:  0.084402 avg.loss:  1.521034 ETA:   0h 0m31sProgress:  15.9% words/sec/thread:  221197 lr:  0.084134 avg.loss:  1.512556 ETA:   0h 0m31sProgress:  16.1% words/sec/thread:  221187 lr:  0.083866 avg.loss:  1.505225 ETA:   0h 0m31sProgress:  16.4% words/sec/thread:  221176 lr:  0.083598 avg.loss:  1.496475 ETA:   0h 0m31sProgress:  16.7% words/sec/thread:  221174 lr:  0.083329 avg.loss:  1.488645 ETA:   0h 0m31sProgress:  16.9% words/sec/thread:  221139 lr:  0.083063 avg.loss:  1.479832 ETA:   0h 0m30sProgress:  17.2% words/sec/thread:  221116 lr:  0.082797 avg.loss:  1.471715 ETA:   0h 0m30sProgress:  17.5% words/sec/thread:  221029 lr:  0.082535 avg.loss:  1.464522 ETA:   0h 0m30sProgress:  17.7% words/sec/thread:  221003 lr:  0.082269 avg.loss:  1.456631 ETA:   0h 0m30sProgress:  18.0% words/sec/thread:  221021 lr:  0.081999 avg.loss:  1.448672 ETA:   0h 0m30sProgress:  18.3% words/sec/thread:  221039 lr:  0.081729 avg.loss:  1.441509 ETA:   0h 0m30sProgress:  18.5% words/sec/thread:  221068 lr:  0.081458 avg.loss:  1.434805 ETA:   0h 0m30sProgress:  18.8% words/sec/thread:  221100 lr:  0.081187 avg.loss:  1.426661 ETA:   0h 0m30sProgress:  19.1% words/sec/thread:  221096 lr:  0.080919 avg.loss:  1.418709 ETA:   0h 0m30sProgress:  19.3% words/sec/thread:  221062 lr:  0.080653 avg.loss:  1.411663 ETA:   0h 0m30sProgress:  19.6% words/sec/thread:  221087 lr:  0.080383 avg.loss:  1.405313 ETA:   0h 0m29sProgress:  19.9% words/sec/thread:  221130 lr:  0.080110 avg.loss:  1.398888 ETA:   0h 0m29sProgress:  20.2% words/sec/thread:  221048 lr:  0.079849 avg.loss:  1.392529 ETA:   0h 0m29sProgress:  20.4% words/sec/thread:  221065 lr:  0.079579 avg.loss:  1.386115 ETA:   0h 0m29sProgress:  20.7% words/sec/thread:  221063 lr:  0.079311 avg.loss:  1.380249 ETA:   0h 0m29sProgress:  21.0% words/sec/thread:  221088 lr:  0.079040 avg.loss:  1.374889 ETA:   0h 0m29sProgress:  21.2% words/sec/thread:  221080 lr:  0.078772 avg.loss:  1.368945 ETA:   0h 0m29sProgress:  21.5% words/sec/thread:  221079 lr:  0.078504 avg.loss:  1.362819 ETA:   0h 0m29sProgress:  21.8% words/sec/thread:  221084 lr:  0.078235 avg.loss:  1.357011 ETA:   0h 0m29sProgress:  22.0% words/sec/thread:  221098 lr:  0.077965 avg.loss:  1.350540 ETA:   0h 0m29sProgress:  22.3% words/sec/thread:  221098 lr:  0.077697 avg.loss:  1.344844 ETA:   0h 0m28sProgress:  22.6% words/sec/thread:  221094 lr:  0.077429 avg.loss:  1.338595 ETA:   0h 0m28sProgress:  22.8% words/sec/thread:  221024 lr:  0.077168 avg.loss:  1.333354 ETA:   0h 0m28sProgress:  23.1% words/sec/thread:  221001 lr:  0.076902 avg.loss:  1.327761 ETA:   0h 0m28sProgress:  23.4% words/sec/thread:  221015 lr:  0.076632 avg.loss:  1.322733 ETA:   0h 0m28sProgress:  23.6% words/sec/thread:  221004 lr:  0.076364 avg.loss:  1.317777 ETA:   0h 0m28sProgress:  23.9% words/sec/thread:  221004 lr:  0.076096 avg.loss:  1.312924 ETA:   0h 0m28sProgress:  24.2% words/sec/thread:  221020 lr:  0.075826 avg.loss:  1.308280 ETA:   0h 0m28sProgress:  24.4% words/sec/thread:  221054 lr:  0.075554 avg.loss:  1.303284 ETA:   0h 0m28sProgress:  24.7% words/sec/thread:  221052 lr:  0.075286 avg.loss:  1.299090 ETA:   0h 0m28sProgress:  25.0% words/sec/thread:  221077 lr:  0.075014 avg.loss:  1.294265 ETA:   0h 0m27sProgress:  25.3% words/sec/thread:  221090 lr:  0.074745 avg.loss:  1.290327 ETA:   0h 0m27sProgress:  25.5% words/sec/thread:  221035 lr:  0.074482 avg.loss:  1.286141 ETA:   0h 0m27sProgress:  25.8% words/sec/thread:  221053 lr:  0.074212 avg.loss:  1.281860 ETA:   0h 0m27sProgress:  26.1% words/sec/thread:  221056 lr:  0.073943 avg.loss:  1.277866 ETA:   0h 0m27sProgress:  26.3% words/sec/thread:  221083 lr:  0.073672 avg.loss:  1.274375 ETA:   0h 0m27sProgress:  26.6% words/sec/thread:  221097 lr:  0.073401 avg.loss:  1.269349 ETA:   0h 0m27sProgress:  26.9% words/sec/thread:  221100 lr:  0.073133 avg.loss:  1.265177 ETA:   0h 0m27sProgress:  27.1% words/sec/thread:  221106 lr:  0.072863 avg.loss:  1.260931 ETA:   0h 0m27sProgress:  27.4% words/sec/thread:  221124 lr:  0.072593 avg.loss:  1.256718 ETA:   0h 0m27sProgress:  27.7% words/sec/thread:  221142 lr:  0.072322 avg.loss:  1.252596 ETA:   0h 0m26sProgress:  27.9% words/sec/thread:  221139 lr:  0.072054 avg.loss:  1.248794 ETA:   0h 0m26sProgress:  28.2% words/sec/thread:  221113 lr:  0.071789 avg.loss:  1.245719 ETA:   0h 0m26sProgress:  28.5% words/sec/thread:  221105 lr:  0.071521 avg.loss:  1.242473 ETA:   0h 0m26sProgress:  28.7% words/sec/thread:  221121 lr:  0.071251 avg.loss:  1.238919 ETA:   0h 0m26sProgress:  29.0% words/sec/thread:  221119 lr:  0.070982 avg.loss:  1.235805 ETA:   0h 0m26sProgress:  29.3% words/sec/thread:  221127 lr:  0.070713 avg.loss:  1.232382 ETA:   0h 0m26sProgress:  29.6% words/sec/thread:  221116 lr:  0.070446 avg.loss:  1.229187 ETA:   0h 0m26sProgress:  29.8% words/sec/thread:  221141 lr:  0.070174 avg.loss:  1.225700 ETA:   0h 0m26sProgress:  30.1% words/sec/thread:  221125 lr:  0.069908 avg.loss:  1.222500 ETA:   0h 0m26sProgress:  30.4% words/sec/thread:  221138 lr:  0.069638 avg.loss:  1.219662 ETA:   0h 0m25sProgress:  30.6% words/sec/thread:  221164 lr:  0.069365 avg.loss:  1.216043 ETA:   0h 0m25sProgress:  30.9% words/sec/thread:  221180 lr:  0.069095 avg.loss:  1.213240 ETA:   0h 0m25sProgress:  31.2% words/sec/thread:  221151 lr:  0.068830 avg.loss:  1.210324 ETA:   0h 0m25sProgress:  31.4% words/sec/thread:  221153 lr:  0.068561 avg.loss:  1.207042 ETA:   0h 0m25sProgress:  31.7% words/sec/thread:  221140 lr:  0.068295 avg.loss:  1.204211 ETA:   0h 0m25sProgress:  32.0% words/sec/thread:  221162 lr:  0.068023 avg.loss:  1.201383 ETA:   0h 0m25sProgress:  32.2% words/sec/thread:  221170 lr:  0.067753 avg.loss:  1.198069 ETA:   0h 0m25sProgress:  32.5% words/sec/thread:  221195 lr:  0.067481 avg.loss:  1.195149 ETA:   0h 0m25sProgress:  32.8% words/sec/thread:  221209 lr:  0.067210 avg.loss:  1.191997 ETA:   0h 0m25sProgress:  33.1% words/sec/thread:  221221 lr:  0.066940 avg.loss:  1.189479 ETA:   0h 0m24sProgress:  33.3% words/sec/thread:  221223 lr:  0.066671 avg.loss:  1.186658 ETA:   0h 0m24sProgress:  33.6% words/sec/thread:  221220 lr:  0.066403 avg.loss:  1.183741 ETA:   0h 0m24sProgress:  33.9% words/sec/thread:  221174 lr:  0.066141 avg.loss:  1.180929 ETA:   0h 0m24sProgress:  34.1% words/sec/thread:  221195 lr:  0.065870 avg.loss:  1.177963 ETA:   0h 0m24sProgress:  34.4% words/sec/thread:  221196 lr:  0.065601 avg.loss:  1.175435 ETA:   0h 0m24sProgress:  34.7% words/sec/thread:  221204 lr:  0.065331 avg.loss:  1.172373 ETA:   0h 0m24sProgress:  34.9% words/sec/thread:  221210 lr:  0.065062 avg.loss:  1.169577 ETA:   0h 0m24sProgress:  35.2% words/sec/thread:  221220 lr:  0.064791 avg.loss:  1.167237 ETA:   0h 0m24sProgress:  35.5% words/sec/thread:  221236 lr:  0.064520 avg.loss:  1.164364 ETA:   0h 0m24sProgress:  35.8% words/sec/thread:  221258 lr:  0.064248 avg.loss:  1.161345 ETA:   0h 0m23sProgress:  36.0% words/sec/thread:  221272 lr:  0.063977 avg.loss:  1.158625 ETA:   0h 0m23sProgress:  36.3% words/sec/thread:  221290 lr:  0.063706 avg.loss:  1.156259 ETA:   0h 0m23sProgress:  36.6% words/sec/thread:  221266 lr:  0.063441 avg.loss:  1.153881 ETA:   0h 0m23sProgress:  36.8% words/sec/thread:  221271 lr:  0.063171 avg.loss:  1.151194 ETA:   0h 0m23sProgress:  37.1% words/sec/thread:  221270 lr:  0.062903 avg.loss:  1.148711 ETA:   0h 0m23sProgress:  37.4% words/sec/thread:  221269 lr:  0.062634 avg.loss:  1.146519 ETA:   0h 0m23sProgress:  37.6% words/sec/thread:  221252 lr:  0.062369 avg.loss:  1.144480 ETA:   0h 0m23sProgress:  37.9% words/sec/thread:  221257 lr:  0.062099 avg.loss:  1.141556 ETA:   0h 0m23sProgress:  38.2% words/sec/thread:  221271 lr:  0.061828 avg.loss:  1.139248 ETA:   0h 0m23sProgress:  38.4% words/sec/thread:  221277 lr:  0.061558 avg.loss:  1.136660 ETA:   0h 0m22sProgress:  38.7% words/sec/thread:  221296 lr:  0.061287 avg.loss:  1.134147 ETA:   0h 0m22sProgress:  39.0% words/sec/thread:  221290 lr:  0.061019 avg.loss:  1.132013 ETA:   0h 0m22sProgress:  39.2% words/sec/thread:  221251 lr:  0.060757 avg.loss:  1.130043 ETA:   0h 0m22sProgress:  39.5% words/sec/thread:  221267 lr:  0.060486 avg.loss:  1.128065 ETA:   0h 0m22sProgress:  39.8% words/sec/thread:  221285 lr:  0.060214 avg.loss:  1.125991 ETA:   0h 0m22sProgress:  40.1% words/sec/thread:  221280 lr:  0.059946 avg.loss:  1.123966 ETA:   0h 0m22sProgress:  40.3% words/sec/thread:  221269 lr:  0.059679 avg.loss:  1.121430 ETA:   0h 0m22sProgress:  40.6% words/sec/thread:  221279 lr:  0.059409 avg.loss:  1.119603 ETA:   0h 0m22sProgress:  40.9% words/sec/thread:  221290 lr:  0.059138 avg.loss:  1.117434 ETA:   0h 0m22sProgress:  41.1% words/sec/thread:  221316 lr:  0.058865 avg.loss:  1.115255 ETA:   0h 0m21sProgress:  41.4% words/sec/thread:  221325 lr:  0.058594 avg.loss:  1.112909 ETA:   0h 0m21sProgress:  41.7% words/sec/thread:  221338 lr:  0.058323 avg.loss:  1.110886 ETA:   0h 0m21sProgress:  41.9% words/sec/thread:  221299 lr:  0.058062 avg.loss:  1.108683 ETA:   0h 0m21sProgress:  42.2% words/sec/thread:  221303 lr:  0.057792 avg.loss:  1.106414 ETA:   0h 0m21sProgress:  42.5% words/sec/thread:  221294 lr:  0.057525 avg.loss:  1.103952 ETA:   0h 0m21sProgress:  42.7% words/sec/thread:  221313 lr:  0.057253 avg.loss:  1.101766 ETA:   0h 0m21sProgress:  43.0% words/sec/thread:  221321 lr:  0.056983 avg.loss:  1.099527 ETA:   0h 0m21sProgress:  43.3% words/sec/thread:  221264 lr:  0.056725 avg.loss:  1.097430 ETA:   0h 0m21sProgress:  43.5% words/sec/thread:  221274 lr:  0.056455 avg.loss:  1.095625 ETA:   0h 0m21sProgress:  43.8% words/sec/thread:  221269 lr:  0.056187 avg.loss:  1.093550 ETA:   0h 0m20sProgress:  44.1% words/sec/thread:  221281 lr:  0.055916 avg.loss:  1.091722 ETA:   0h 0m20sProgress:  44.4% words/sec/thread:  221284 lr:  0.055646 avg.loss:  1.089769 ETA:   0h 0m20sProgress:  44.6% words/sec/thread:  221261 lr:  0.055382 avg.loss:  1.088263 ETA:   0h 0m20sProgress:  44.9% words/sec/thread:  221252 lr:  0.055116 avg.loss:  1.086469 ETA:   0h 0m20sProgress:  45.2% words/sec/thread:  221247 lr:  0.054848 avg.loss:  1.084812 ETA:   0h 0m20sProgress:  45.4% words/sec/thread:  221240 lr:  0.054581 avg.loss:  1.082642 ETA:   0h 0m20sProgress:  45.7% words/sec/thread:  221247 lr:  0.054311 avg.loss:  1.080596 ETA:   0h 0m20sProgress:  46.0% words/sec/thread:  221275 lr:  0.054036 avg.loss:  1.078825 ETA:   0h 0m20sProgress:  46.2% words/sec/thread:  221282 lr:  0.053766 avg.loss:  1.077612 ETA:   0h 0m20sProgress:  46.5% words/sec/thread:  221288 lr:  0.053496 avg.loss:  1.076455 ETA:   0h 0m19sProgress:  46.8% words/sec/thread:  221291 lr:  0.053227 avg.loss:  1.075261 ETA:   0h 0m19sProgress:  47.0% words/sec/thread:  221303 lr:  0.052956 avg.loss:  1.074283 ETA:   0h 0m19sProgress:  47.3% words/sec/thread:  221308 lr:  0.052686 avg.loss:  1.072984 ETA:   0h 0m19sProgress:  47.6% words/sec/thread:  221291 lr:  0.052421 avg.loss:  1.071589 ETA:   0h 0m19sProgress:  47.9% words/sec/thread:  221304 lr:  0.052149 avg.loss:  1.070374 ETA:   0h 0m19sProgress:  48.1% words/sec/thread:  221301 lr:  0.051881 avg.loss:  1.069057 ETA:   0h 0m19sProgress:  48.4% words/sec/thread:  221317 lr:  0.051609 avg.loss:  1.067562 ETA:   0h 0m19sProgress:  48.7% words/sec/thread:  221323 lr:  0.051339 avg.loss:  1.065980 ETA:   0h 0m19sProgress:  48.9% words/sec/thread:  221318 lr:  0.051071 avg.loss:  1.064532 ETA:   0h 0m19sProgress:  49.2% words/sec/thread:  221317 lr:  0.050803 avg.loss:  1.063046 ETA:   0h 0m18sProgress:  49.5% words/sec/thread:  221323 lr:  0.050533 avg.loss:  1.061725 ETA:   0h 0m18sProgress:  49.7% words/sec/thread:  221337 lr:  0.050261 avg.loss:  1.060636 ETA:   0h 0m18sProgress:  50.0% words/sec/thread:  221346 lr:  0.049990 avg.loss:  1.059692 ETA:   0h 0m18sProgress:  50.3% words/sec/thread:  221320 lr:  0.049728 avg.loss:  1.058633 ETA:   0h 0m18sProgress:  50.5% words/sec/thread:  221326 lr:  0.049457 avg.loss:  1.057492 ETA:   0h 0m18sProgress:  50.8% words/sec/thread:  221334 lr:  0.049187 avg.loss:  1.056457 ETA:   0h 0m18sProgress:  51.1% words/sec/thread:  221351 lr:  0.048915 avg.loss:  1.055236 ETA:   0h 0m18sProgress:  51.4% words/sec/thread:  221344 lr:  0.048647 avg.loss:  1.054034 ETA:   0h 0m18sProgress:  51.6% words/sec/thread:  221355 lr:  0.048376 avg.loss:  1.052721 ETA:   0h 0m18sProgress:  51.9% words/sec/thread:  221366 lr:  0.048104 avg.loss:  1.051648 ETA:   0h 0m17sProgress:  52.2% words/sec/thread:  221362 lr:  0.047837 avg.loss:  1.050374 ETA:   0h 0m17sProgress:  52.4% words/sec/thread:  221373 lr:  0.047565 avg.loss:  1.049402 ETA:   0h 0m17sProgress:  52.7% words/sec/thread:  221378 lr:  0.047296 avg.loss:  1.048124 ETA:   0h 0m17sProgress:  53.0% words/sec/thread:  221348 lr:  0.047034 avg.loss:  1.046836 ETA:   0h 0m17sProgress:  53.2% words/sec/thread:  221355 lr:  0.046763 avg.loss:  1.045287 ETA:   0h 0m17sProgress:  53.5% words/sec/thread:  221363 lr:  0.046492 avg.loss:  1.044436 ETA:   0h 0m17sProgress:  53.8% words/sec/thread:  221338 lr:  0.046229 avg.loss:  1.043257 ETA:   0h 0m17sProgress:  54.0% words/sec/thread:  221353 lr:  0.045957 avg.loss:  1.042068 ETA:   0h 0m17sProgress:  54.3% words/sec/thread:  221360 lr:  0.045687 avg.loss:  1.040940 ETA:   0h 0m17sProgress:  54.6% words/sec/thread:  221361 lr:  0.045418 avg.loss:  1.039740 ETA:   0h 0m16sProgress:  54.9% words/sec/thread:  221371 lr:  0.045146 avg.loss:  1.038830 ETA:   0h 0m16sProgress:  55.1% words/sec/thread:  221378 lr:  0.044876 avg.loss:  1.037476 ETA:   0h 0m16sProgress:  55.4% words/sec/thread:  221388 lr:  0.044604 avg.loss:  1.036217 ETA:   0h 0m16sProgress:  55.7% words/sec/thread:  221360 lr:  0.044343 avg.loss:  1.034946 ETA:   0h 0m16sProgress:  55.9% words/sec/thread:  221372 lr:  0.044071 avg.loss:  1.033996 ETA:   0h 0m16sProgress:  56.2% words/sec/thread:  221363 lr:  0.043805 avg.loss:  1.032855 ETA:   0h 0m16sProgress:  56.5% words/sec/thread:  221378 lr:  0.043532 avg.loss:  1.031944 ETA:   0h 0m16sProgress:  56.7% words/sec/thread:  221378 lr:  0.043263 avg.loss:  1.030582 ETA:   0h 0m16sProgress:  57.0% words/sec/thread:  221377 lr:  0.042994 avg.loss:  1.029199 ETA:   0h 0m16sProgress:  57.3% words/sec/thread:  221376 lr:  0.042726 avg.loss:  1.027878 ETA:   0h 0m15sProgress:  57.5% words/sec/thread:  221376 lr:  0.042457 avg.loss:  1.026757 ETA:   0h 0m15sProgress:  57.8% words/sec/thread:  221377 lr:  0.042188 avg.loss:  1.026038 ETA:   0h 0m15sProgress:  58.1% words/sec/thread:  221383 lr:  0.041917 avg.loss:  1.024716 ETA:   0h 0m15sProgress:  58.3% words/sec/thread:  221367 lr:  0.041653 avg.loss:  1.023801 ETA:   0h 0m15sProgress:  58.6% words/sec/thread:  221359 lr:  0.041386 avg.loss:  1.022748 ETA:   0h 0m15sProgress:  58.9% words/sec/thread:  221366 lr:  0.041116 avg.loss:  1.021841 ETA:   0h 0m15sProgress:  59.2% words/sec/thread:  221363 lr:  0.040848 avg.loss:  1.020803 ETA:   0h 0m15sProgress:  59.4% words/sec/thread:  221362 lr:  0.040579 avg.loss:  1.019666 ETA:   0h 0m15sProgress:  59.7% words/sec/thread:  221369 lr:  0.040309 avg.loss:  1.018596 ETA:   0h 0m15sProgress:  60.0% words/sec/thread:  221375 lr:  0.040038 avg.loss:  1.017696 ETA:   0h 0m14sProgress:  60.2% words/sec/thread:  221380 lr:  0.039768 avg.loss:  1.016496 ETA:   0h 0m14sProgress:  60.5% words/sec/thread:  221379 lr:  0.039499 avg.loss:  1.015388 ETA:   0h 0m14sProgress:  60.8% words/sec/thread:  221376 lr:  0.039231 avg.loss:  1.014025 ETA:   0h 0m14sProgress:  61.0% words/sec/thread:  221359 lr:  0.038967 avg.loss:  1.013116 ETA:   0h 0m14sProgress:  61.3% words/sec/thread:  221354 lr:  0.038700 avg.loss:  1.012259 ETA:   0h 0m14sProgress:  61.6% words/sec/thread:  221357 lr:  0.038430 avg.loss:  1.011506 ETA:   0h 0m14sProgress:  61.8% words/sec/thread:  221356 lr:  0.038162 avg.loss:  1.010466 ETA:   0h 0m14sProgress:  62.1% words/sec/thread:  221365 lr:  0.037890 avg.loss:  1.009825 ETA:   0h 0m14sProgress:  62.4% words/sec/thread:  221379 lr:  0.037617 avg.loss:  1.008803 ETA:   0h 0m14sProgress:  62.7% words/sec/thread:  221376 lr:  0.037350 avg.loss:  1.007692 ETA:   0h 0m13sProgress:  62.9% words/sec/thread:  221376 lr:  0.037081 avg.loss:  1.006877 ETA:   0h 0m13sProgress:  63.2% words/sec/thread:  221389 lr:  0.036808 avg.loss:  1.005874 ETA:   0h 0m13sProgress:  63.5% words/sec/thread:  221387 lr:  0.036540 avg.loss:  1.004845 ETA:   0h 0m13sProgress:  63.7% words/sec/thread:  221389 lr:  0.036261 avg.loss:  1.003945 ETA:   0h 0m13sProgress:  64.0% words/sec/thread:  221379 lr:  0.035995 avg.loss:  1.003255 ETA:   0h 0m13sProgress:  64.3% words/sec/thread:  221385 lr:  0.035724 avg.loss:  1.002166 ETA:   0h 0m13sProgress:  64.5% words/sec/thread:  221393 lr:  0.035453 avg.loss:  1.000965 ETA:   0h 0m13sProgress:  64.8% words/sec/thread:  221388 lr:  0.035186 avg.loss:  0.999828 ETA:   0h 0m13sProgress:  65.1% words/sec/thread:  221397 lr:  0.034914 avg.loss:  0.999003 ETA:   0h 0m12sProgress:  65.4% words/sec/thread:  221412 lr:  0.034641 avg.loss:  0.998170 ETA:   0h 0m12sProgress:  65.6% words/sec/thread:  221412 lr:  0.034372 avg.loss:  0.997210 ETA:   0h 0m12sProgress:  65.9% words/sec/thread:  221416 lr:  0.034102 avg.loss:  0.996096 ETA:   0h 0m12sProgress:  66.2% words/sec/thread:  221425 lr:  0.033831 avg.loss:  0.995147 ETA:   0h 0m12sProgress:  66.4% words/sec/thread:  221432 lr:  0.033559 avg.loss:  0.994357 ETA:   0h 0m12sProgress:  66.7% words/sec/thread:  221413 lr:  0.033297 avg.loss:  0.993474 ETA:   0h 0m12sProgress:  67.0% words/sec/thread:  221422 lr:  0.033025 avg.loss:  0.992582 ETA:   0h 0m12sProgress:  67.2% words/sec/thread:  221424 lr:  0.032755 avg.loss:  0.991569 ETA:   0h 0m12sProgress:  67.5% words/sec/thread:  221429 lr:  0.032485 avg.loss:  0.990449 ETA:   0h 0m12sProgress:  67.8% words/sec/thread:  221426 lr:  0.032217 avg.loss:  0.989407 ETA:   0h 0m11sProgress:  68.1% words/sec/thread:  221421 lr:  0.031950 avg.loss:  0.988171 ETA:   0h 0m11sProgress:  68.3% words/sec/thread:  221419 lr:  0.031681 avg.loss:  0.987209 ETA:   0h 0m11sProgress:  68.6% words/sec/thread:  221416 lr:  0.031414 avg.loss:  0.986114 ETA:   0h 0m11sProgress:  68.9% words/sec/thread:  221415 lr:  0.031145 avg.loss:  0.985212 ETA:   0h 0m11sProgress:  69.1% words/sec/thread:  221416 lr:  0.030876 avg.loss:  0.984259 ETA:   0h 0m11sProgress:  69.4% words/sec/thread:  221397 lr:  0.030613 avg.loss:  0.983269 ETA:   0h 0m11sProgress:  69.7% words/sec/thread:  221401 lr:  0.030343 avg.loss:  0.982422 ETA:   0h 0m11sProgress:  69.9% words/sec/thread:  221408 lr:  0.030072 avg.loss:  0.981380 ETA:   0h 0m11sProgress:  70.2% words/sec/thread:  221412 lr:  0.029802 avg.loss:  0.980637 ETA:   0h 0m11sProgress:  70.5% words/sec/thread:  221413 lr:  0.029532 avg.loss:  0.979785 ETA:   0h 0m10sProgress:  70.7% words/sec/thread:  221401 lr:  0.029268 avg.loss:  0.979064 ETA:   0h 0m10sProgress:  71.0% words/sec/thread:  221406 lr:  0.028997 avg.loss:  0.978273 ETA:   0h 0m10sProgress:  71.3% words/sec/thread:  221403 lr:  0.028729 avg.loss:  0.977402 ETA:   0h 0m10sProgress:  71.5% words/sec/thread:  221408 lr:  0.028459 avg.loss:  0.976691 ETA:   0h 0m10sProgress:  71.8% words/sec/thread:  221409 lr:  0.028189 avg.loss:  0.976005 ETA:   0h 0m10sProgress:  72.1% words/sec/thread:  221384 lr:  0.027929 avg.loss:  0.975002 ETA:   0h 0m10sProgress:  72.3% words/sec/thread:  221378 lr:  0.027662 avg.loss:  0.974210 ETA:   0h 0m10sProgress:  72.6% words/sec/thread:  221382 lr:  0.027392 avg.loss:  0.973336 ETA:   0h 0m10sProgress:  72.9% words/sec/thread:  221389 lr:  0.027120 avg.loss:  0.972334 ETA:   0h 0m10sProgress:  73.2% words/sec/thread:  221400 lr:  0.026848 avg.loss:  0.971277 ETA:   0h 0m 9sProgress:  73.4% words/sec/thread:  221407 lr:  0.026577 avg.loss:  0.970429 ETA:   0h 0m 9sProgress:  73.7% words/sec/thread:  221411 lr:  0.026307 avg.loss:  0.969685 ETA:   0h 0m 9sProgress:  74.0% words/sec/thread:  221420 lr:  0.026035 avg.loss:  0.968858 ETA:   0h 0m 9sProgress:  74.2% words/sec/thread:  221425 lr:  0.025765 avg.loss:  0.968052 ETA:   0h 0m 9sProgress:  74.5% words/sec/thread:  221424 lr:  0.025496 avg.loss:  0.967367 ETA:   0h 0m 9sProgress:  74.8% words/sec/thread:  221407 lr:  0.025233 avg.loss:  0.966674 ETA:   0h 0m 9sProgress:  75.0% words/sec/thread:  221404 lr:  0.024965 avg.loss:  0.965795 ETA:   0h 0m 9sProgress:  75.3% words/sec/thread:  221402 lr:  0.024697 avg.loss:  0.964988 ETA:   0h 0m 9sProgress:  75.6% words/sec/thread:  221398 lr:  0.024429 avg.loss:  0.964168 ETA:   0h 0m 9sProgress:  75.8% words/sec/thread:  221405 lr:  0.024158 avg.loss:  0.963559 ETA:   0h 0m 8sProgress:  76.1% words/sec/thread:  221409 lr:  0.023888 avg.loss:  0.962636 ETA:   0h 0m 8sProgress:  76.4% words/sec/thread:  221415 lr:  0.023617 avg.loss:  0.961908 ETA:   0h 0m 8sProgress:  76.7% words/sec/thread:  221416 lr:  0.023348 avg.loss:  0.961213 ETA:   0h 0m 8sProgress:  76.9% words/sec/thread:  221418 lr:  0.023078 avg.loss:  0.960396 ETA:   0h 0m 8sProgress:  77.2% words/sec/thread:  221421 lr:  0.022808 avg.loss:  0.959695 ETA:   0h 0m 8sProgress:  77.5% words/sec/thread:  221406 lr:  0.022545 avg.loss:  0.959051 ETA:   0h 0m 8sProgress:  77.7% words/sec/thread:  221403 lr:  0.022277 avg.loss:  0.958154 ETA:   0h 0m 8sProgress:  78.0% words/sec/thread:  221401 lr:  0.022008 avg.loss:  0.957249 ETA:   0h 0m 8sProgress:  78.3% words/sec/thread:  221407 lr:  0.021738 avg.loss:  0.956533 ETA:   0h 0m 8sProgress:  78.5% words/sec/thread:  221409 lr:  0.021468 avg.loss:  0.955947 ETA:   0h 0m 7sProgress:  78.8% words/sec/thread:  221414 lr:  0.021198 avg.loss:  0.955208 ETA:   0h 0m 7sProgress:  79.1% words/sec/thread:  221418 lr:  0.020927 avg.loss:  0.954420 ETA:   0h 0m 7sProgress:  79.3% words/sec/thread:  221421 lr:  0.020657 avg.loss:  0.953709 ETA:   0h 0m 7sProgress:  79.6% words/sec/thread:  221421 lr:  0.020388 avg.loss:  0.952976 ETA:   0h 0m 7sProgress:  79.9% words/sec/thread:  221426 lr:  0.020118 avg.loss:  0.952249 ETA:   0h 0m 7sProgress:  80.1% words/sec/thread:  221417 lr:  0.019852 avg.loss:  0.951435 ETA:   0h 0m 7sProgress:  80.4% words/sec/thread:  221409 lr:  0.019586 avg.loss:  0.950691 ETA:   0h 0m 7sProgress:  80.7% words/sec/thread:  221404 lr:  0.019319 avg.loss:  0.950060 ETA:   0h 0m 7sProgress:  80.9% words/sec/thread:  221401 lr:  0.019051 avg.loss:  0.949213 ETA:   0h 0m 7sProgress:  81.2% words/sec/thread:  221407 lr:  0.018780 avg.loss:  0.948241 ETA:   0h 0m 6sProgress:  81.5% words/sec/thread:  221409 lr:  0.018511 avg.loss:  0.947398 ETA:   0h 0m 6sProgress:  81.8% words/sec/thread:  221417 lr:  0.018239 avg.loss:  0.946768 ETA:   0h 0m 6sProgress:  82.0% words/sec/thread:  221423 lr:  0.017968 avg.loss:  0.946049 ETA:   0h 0m 6sProgress:  82.3% words/sec/thread:  221421 lr:  0.017700 avg.loss:  0.945282 ETA:   0h 0m 6sProgress:  82.6% words/sec/thread:  221418 lr:  0.017432 avg.loss:  0.944650 ETA:   0h 0m 6sProgress:  82.8% words/sec/thread:  221421 lr:  0.017162 avg.loss:  0.944041 ETA:   0h 0m 6sProgress:  83.1% words/sec/thread:  221406 lr:  0.016899 avg.loss:  0.943537 ETA:   0h 0m 6sProgress:  83.4% words/sec/thread:  221408 lr:  0.016629 avg.loss:  0.942693 ETA:   0h 0m 6sProgress:  83.6% words/sec/thread:  221417 lr:  0.016357 avg.loss:  0.941929 ETA:   0h 0m 6sProgress:  83.9% words/sec/thread:  221424 lr:  0.016086 avg.loss:  0.941183 ETA:   0h 0m 5sProgress:  84.2% words/sec/thread:  221428 lr:  0.015815 avg.loss:  0.940435 ETA:   0h 0m 5sProgress:  84.5% words/sec/thread:  221428 lr:  0.015546 avg.loss:  0.939817 ETA:   0h 0m 5sProgress:  84.7% words/sec/thread:  221436 lr:  0.015274 avg.loss:  0.939108 ETA:   0h 0m 5sProgress:  85.0% words/sec/thread:  221430 lr:  0.015008 avg.loss:  0.938537 ETA:   0h 0m 5sProgress:  85.3% words/sec/thread:  221433 lr:  0.014738 avg.loss:  0.937980 ETA:   0h 0m 5sProgress:  85.5% words/sec/thread:  221432 lr:  0.014469 avg.loss:  0.937388 ETA:   0h 0m 5sProgress:  85.8% words/sec/thread:  221418 lr:  0.014206 avg.loss:  0.936772 ETA:   0h 0m 5sProgress:  86.1% words/sec/thread:  221414 lr:  0.013938 avg.loss:  0.936205 ETA:   0h 0m 5sProgress:  86.3% words/sec/thread:  221417 lr:  0.013668 avg.loss:  0.935575 ETA:   0h 0m 5sProgress:  86.6% words/sec/thread:  221422 lr:  0.013397 avg.loss:  0.934948 ETA:   0h 0m 4sProgress:  86.9% words/sec/thread:  221423 lr:  0.013128 avg.loss:  0.934292 ETA:   0h 0m 4sProgress:  87.1% words/sec/thread:  221422 lr:  0.012860 avg.loss:  0.933496 ETA:   0h 0m 4sProgress:  87.4% words/sec/thread:  221419 lr:  0.012592 avg.loss:  0.932864 ETA:   0h 0m 4sProgress:  87.7% words/sec/thread:  221416 lr:  0.012325 avg.loss:  0.932104 ETA:   0h 0m 4sProgress:  87.9% words/sec/thread:  221407 lr:  0.012059 avg.loss:  0.931440 ETA:   0h 0m 4sProgress:  88.2% words/sec/thread:  221405 lr:  0.011791 avg.loss:  0.930896 ETA:   0h 0m 4sProgress:  88.5% words/sec/thread:  221376 lr:  0.011534 avg.loss:  0.930285 ETA:   0h 0m 4sProgress:  88.7% words/sec/thread:  221380 lr:  0.011264 avg.loss:  0.929574 ETA:   0h 0m 4sProgress:  89.0% words/sec/thread:  221377 lr:  0.010996 avg.loss:  0.928906 ETA:   0h 0m 4sProgress:  89.3% words/sec/thread:  221370 lr:  0.010730 avg.loss:  0.928476 ETA:   0h 0m 3sProgress:  89.5% words/sec/thread:  221378 lr:  0.010458 avg.loss:  0.927969 ETA:   0h 0m 3sProgress:  89.8% words/sec/thread:  221379 lr:  0.010189 avg.loss:  0.927503 ETA:   0h 0m 3sProgress:  90.1% words/sec/thread:  221383 lr:  0.009918 avg.loss:  0.927008 ETA:   0h 0m 3sProgress:  90.4% words/sec/thread:  221388 lr:  0.009647 avg.loss:  0.926594 ETA:   0h 0m 3sProgress:  90.6% words/sec/thread:  221388 lr:  0.009379 avg.loss:  0.926166 ETA:   0h 0m 3sProgress:  90.9% words/sec/thread:  221388 lr:  0.009110 avg.loss:  0.925497 ETA:   0h 0m 3sProgress:  91.2% words/sec/thread:  221371 lr:  0.008848 avg.loss:  0.924981 ETA:   0h 0m 3sProgress:  91.4% words/sec/thread:  221377 lr:  0.008577 avg.loss:  0.924425 ETA:   0h 0m 3sProgress:  91.7% words/sec/thread:  221376 lr:  0.008308 avg.loss:  0.923912 ETA:   0h 0m 3sProgress:  92.0% words/sec/thread:  221379 lr:  0.008038 avg.loss:  0.923364 ETA:   0h 0m 2sProgress:  92.2% words/sec/thread:  221378 lr:  0.007770 avg.loss:  0.922927 ETA:   0h 0m 2sProgress:  92.5% words/sec/thread:  221381 lr:  0.007499 avg.loss:  0.922607 ETA:   0h 0m 2sProgress:  92.8% words/sec/thread:  221385 lr:  0.007229 avg.loss:  0.922185 ETA:   0h 0m 2sProgress:  93.0% words/sec/thread:  221384 lr:  0.006961 avg.loss:  0.921527 ETA:   0h 0m 2sProgress:  93.3% words/sec/thread:  221388 lr:  0.006690 avg.loss:  0.921057 ETA:   0h 0m 2sProgress:  93.6% words/sec/thread:  221390 lr:  0.006421 avg.loss:  0.920510 ETA:   0h 0m 2sProgress:  93.8% words/sec/thread:  221380 lr:  0.006156 avg.loss:  0.920028 ETA:   0h 0m 2sProgress:  94.1% words/sec/thread:  221385 lr:  0.005885 avg.loss:  0.919332 ETA:   0h 0m 2sProgress:  94.4% words/sec/thread:  221387 lr:  0.005615 avg.loss:  0.918791 ETA:   0h 0m 2sProgress:  94.7% words/sec/thread:  221385 lr:  0.005347 avg.loss:  0.918037 ETA:   0h 0m 1sProgress:  94.9% words/sec/thread:  221387 lr:  0.005077 avg.loss:  0.917514 ETA:   0h 0m 1sProgress:  95.2% words/sec/thread:  221392 lr:  0.004807 avg.loss:  0.917060 ETA:   0h 0m 1sProgress:  95.5% words/sec/thread:  221397 lr:  0.004536 avg.loss:  0.916749 ETA:   0h 0m 1sProgress:  95.7% words/sec/thread:  221402 lr:  0.004265 avg.loss:  0.916309 ETA:   0h 0m 1sProgress:  96.0% words/sec/thread:  221409 lr:  0.003993 avg.loss:  0.915791 ETA:   0h 0m 1sProgress:  96.3% words/sec/thread:  221414 lr:  0.003722 avg.loss:  0.915394 ETA:   0h 0m 1sProgress:  96.5% words/sec/thread:  221414 lr:  0.003453 avg.loss:  0.914936 ETA:   0h 0m 1sProgress:  96.8% words/sec/thread:  221416 lr:  0.003183 avg.loss:  0.914423 ETA:   0h 0m 1sProgress:  97.1% words/sec/thread:  221419 lr:  0.002913 avg.loss:  0.913833 ETA:   0h 0m 1sProgress:  97.4% words/sec/thread:  221427 lr:  0.002641 avg.loss:  0.913373 ETA:   0h 0m 0sProgress:  97.6% words/sec/thread:  221432 lr:  0.002370 avg.loss:  0.912932 ETA:   0h 0m 0sProgress:  97.9% words/sec/thread:  221440 lr:  0.002097 avg.loss:  0.912378 ETA:   0h 0m 0sProgress:  98.2% words/sec/thread:  221444 lr:  0.001827 avg.loss:  0.911868 ETA:   0h 0m 0sProgress:  98.4% words/sec/thread:  221441 lr:  0.001559 avg.loss:  0.911224 ETA:   0h 0m 0sProgress:  98.7% words/sec/thread:  221442 lr:  0.001290 avg.loss:  0.910578 ETA:   0h 0m 0sProgress:  99.0% words/sec/thread:  221444 lr:  0.001020 avg.loss:  0.910185 ETA:   0h 0m 0sProgress:  99.3% words/sec/thread:  221451 lr:  0.000748 avg.loss:  0.909581 ETA:   0h 0m 0sProgress:  99.5% words/sec/thread:  221438 lr:  0.000485 avg.loss:  0.909115 ETA:   0h 0m 0sProgress:  99.8% words/sec/thread:  221440 lr:  0.000215 avg.loss:  0.908633 ETA:   0h 0m 0sProgress: 100.0% words/sec/thread:  221321 lr: -0.000000 avg.loss:  0.908223 ETA:   0h 0m 0sProgress: 100.0% words/sec/thread:  221320 lr:  0.000000 avg.loss:  0.908223 ETA:   0h 0m 0s</code></pre>
</div>
</div>
<div id="b0a83a0c" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Label</th>
<th data-quarto-table-cell-role="th">IC</th>
<th data-quarto-table-cell-role="th">Code</th>
<th data-quarto-table-cell-role="th">Libellé</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>4799A</td>
<td>0.809980</td>
<td>4799A</td>
<td>Vente à domicile</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4791B</td>
<td>0.098938</td>
<td>4791B</td>
<td>Vente à distance sur catalogue spécialisé</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4789Z</td>
<td>0.052251</td>
<td>4789Z</td>
<td>Autres commerces de détail sur éventaires et m...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1071C</td>
<td>0.992017</td>
<td>1071C</td>
<td>Boulangerie et boulangerie-pâtisserie</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1071B</td>
<td>0.004299</td>
<td>1071B</td>
<td>Cuisson de produits de boulangerie</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>9001Z</td>
<td>0.002068</td>
<td>9001Z</td>
<td>Arts du spectacle vivant</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="b122e15f" class="cell" data-execution_count="18">
<div class="cell-output cell-output-display" data-execution_count="18">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">correct_predictions</th>
<th data-quarto-table-cell-role="th">total</th>
<th data-quarto-table-cell-role="th">recall</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">nace</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4719B</td>
<td>17</td>
<td>204</td>
<td>0.083333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4642Z</td>
<td>39</td>
<td>270</td>
<td>0.144444</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6832A</td>
<td>67</td>
<td>241</td>
<td>0.278008</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4778C</td>
<td>130</td>
<td>429</td>
<td>0.303030</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4782Z</td>
<td>135</td>
<td>309</td>
<td>0.436893</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8623Z</td>
<td>394</td>
<td>402</td>
<td>0.980100</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3511Z</td>
<td>2331</td>
<td>2375</td>
<td>0.981474</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5320Z</td>
<td>6711</td>
<td>6806</td>
<td>0.986042</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5520Z</td>
<td>12616</td>
<td>12792</td>
<td>0.986241</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8690D</td>
<td>1589</td>
<td>1610</td>
<td>0.986957</td>
</tr>
</tbody>
</table>

<p>127 rows × 3 columns</p>
</div>
</div>
</div>
</div>
<div id="cbb72089" class="cell" data-execution_count="19">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ape_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pour-aller-plus-loin-introduction-au-mlops" class="level2">
<h2 class="anchored" data-anchor-id="pour-aller-plus-loin-introduction-au-mlops">Pour aller plus loin, introduction au MLOps</h2>
<p>On utilise dans cette application un modèle de Machine Learning (ML) pour prédire l’activité des entreprises à partir de texte descriptifs. Les méthodes de ML sont quasiment indispensables pour traiter du texte, mais utiliser des modèles de ML pour servir des cas d’usage réels demande de respecter un certain nombre de bonnes pratiques pour que tout se passe convenablement, en particulier:</p>
<ul>
<li>Tracking propre des expérimentations</li>
<li>Versioning des modèles, en même temps que des données et du code correspondants</li>
<li>Mise à disposition efficace du modèle aux utilisateurs</li>
<li>Monitoring de l’activité du modèle servi</li>
<li>Réentraînement du modèle</li>
</ul>
<p>Une introduction à ces bonnes pratiques, auxquelles on fait régulièrement référence à travers le terme MLOps, est donné dans <a href="https://inseefrlab.github.io/formation-mlops/slides/fr/index.html#/title-slide">cette formation</a> (<a href="https://github.com/InseeFrLab/formation-mlops">dépôt associé</a>).</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../textes.html" class="pagination-link" aria-label="Données textuelles et non structurées">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Données textuelles et non structurées</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../textes_exemples.html" class="pagination-link" aria-label="Application 2">
        <span class="nav-page-text">Application 2</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<ol start="3" type="a">
<li>2022, Lino Galiana and Tom Seimandi</li>
</ol>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/InseeFrLab/cours-nouvelles-donnees-site/edit/main/applications/ape.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/InseeFrLab/cours-nouvelles-donnees-site/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/InseeFrLab/cours-nouvelles-donnees-site">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>